var comm_chat_send=function(e,t){console.log("js向客户端发送信息:"+e+"|"+t),window.AcJs_get(e,t)},comm_chat_set=function(e,t){var r=JSON.parse(Base64.decode(t));try{"data"==e?"tranCopy"==r.type?CHAT.showTranCopy(r.value):console.error("error type : data "+r.type):console.error("error type : "+e+" "+r.type)}catch(e){console.log(e)}},CHAT={language:"Cn",showTranCopy:function(e){var t=null,r="",a="",n=0;try{t=JSON.parse(e.data),a=t.query}catch(t){"Cn"==e.lang?(a=":-(",r="没有找到对应的翻译结果"):(a=":-(",r="Fail to find the corresponding translation"),n=1}$(".chatContainer").find(".tranConCopy");if(0==n)try{if(t.basic){a=t.query,(t.basic["uk-phonetic"]||t.basic.phonetic)&&(a+="[",a+=t.basic["uk-phonetic"]?t.basic["uk-phonetic"]:t.basic.phonetic,a+="]");for(var o=0;o<t.basic.explains.length;o++)r+=t.basic.explains[o],o+1<t.basic.explains.length&&(r+="\n")}else{a=t.query;for(var o=0;o<t.translation.length;o++)r+=t.translation[o],o+1<t.translation.length&&(r+="\n")}}catch(e){console.error(e)}$(".trans_select").css("display","block"),document.getElementById("src_selected").innerHTML=CHAT.removeDanger(a),document.getElementById("res_selected").innerHTML=CHAT.removeDanger(r),"Cn"==e.lang&&($(".youdao").html('此结果由<a href="" >有道</a>提供'),$(".toolCon").find(".copy").html('<img src="./images/chat/ctrlc.gif" />复制'),$(".toolCon").find(".send").html('<img src="./images/chat/send.png" />发送')),setTimeout(function(){var e={type:"showTransRes",data:{value:$(".trans_select").height().toString()}};comm_chat_send("showTransRes",Base64.encode(JSON.stringify(e)))},5)},tranClick:function(e){var t=null;switch(""==e.target.className?e.target.parentNode.className:e.target.className){case"copy":t={type:"copy",data:{value:$("#src_selected").text()+"\r\n"+$("#res_selected").text()}};break;case"send":t={type:"sent",data:{value:$("#src_selected").text()+"\r\n"+$("#res_selected").text()}}}t&&comm_chat_send("ButTrans",Base64.encode(JSON.stringify(t)))},eventBind:function(){$(".trans_select").bind("click",function(e){CHAT.tranClick(e),e.preventDefault(),e.stopPropagation()})},removeDanger:function(e){var t=e;return t=t.replace(/&/g,"&amp;"),t=t.replace(/\\/g,"&quot;"),t=t.replace(/'/g,"&#039;"),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;")}},Base64={table:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],UTF16ToUTF8:function(e){for(var t=[],r=e.length,a=0;a<r;a++){var n=e.charCodeAt(a);if(n>0&&n<=127)t.push(e.charAt(a));else if(n>=128&&n<=2047){var o=192|n>>6&31,c=128|63&n;t.push(String.fromCharCode(o),String.fromCharCode(c))}else if(n>=2048&&n<=65535){var o=224|n>>12&15,c=128|n>>6&63,s=128|63&n;t.push(String.fromCharCode(o),String.fromCharCode(c),String.fromCharCode(s))}}return t.join("")},UTF8ToUTF16:function(e){for(var t=[],r=e.length,a=0,a=0;a<r;a++){var n=e.charCodeAt(a);if(0==(n>>7&255))t.push(e.charAt(a));else if(6==(n>>5&255)){var o=e.charCodeAt(++a),c=(31&n)<<6,s=63&o,i=c|s;t.push(String.fromCharCode(i))}else if(14==(n>>4&255)){var o=e.charCodeAt(++a),h=e.charCodeAt(++a),c=n<<4|o>>2&15,s=(3&o)<<6|63&h;i=(255&c)<<8|s,t.push(String.fromCharCode(i))}}return t.join("")},encode:function(e){if(!e)return"";for(var t=this.UTF16ToUTF8(e),r=0,a=t.length,n=[];r<a;){var o=255&t.charCodeAt(r++);if(n.push(this.table[o>>2]),r==a){n.push(this.table[(3&o)<<4]),n.push("==");break}var c=t.charCodeAt(r++);if(r==a){n.push(this.table[(3&o)<<4|c>>4&15]),n.push(this.table[(15&c)<<2]),n.push("=");break}var s=t.charCodeAt(r++);n.push(this.table[(3&o)<<4|c>>4&15]),n.push(this.table[(15&c)<<2|(192&s)>>6]),n.push(this.table[63&s])}return n.join("")},decode:function(e){if(!e)return"";for(var t=e.length,r=0,a=[];r<t;)code1=this.table.indexOf(e.charAt(r++)),code2=this.table.indexOf(e.charAt(r++)),code3=this.table.indexOf(e.charAt(r++)),code4=this.table.indexOf(e.charAt(r++)),c1=code1<<2|code2>>4,c2=(15&code2)<<4|code3>>2,c3=(3&code3)<<6|code4,a.push(String.fromCharCode(c1)),64!=code3&&a.push(String.fromCharCode(c2)),64!=code4&&a.push(String.fromCharCode(c3));return this.UTF8ToUTF16(a.join(""))}};